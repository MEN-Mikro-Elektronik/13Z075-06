<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>MEN - Z75 MDIS Driver - z75_drv.c Source File</title>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<meta name="Language" content="en, english">
<meta name="Copyright" content="All material copyright MEN Mikro Elektronik GmbH">
<link href="men_stylesheet.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class="left_to_right" style="padding-top: 6px; background-color: #F0F0F0; height: 110px; border-bottom: 2px solid #D1D1D2;">
	<!-- Titel -->
	<img src="menlogo.gif" alt="MEN" style="float: left; height: 103px; width: 155px; margin: 0px;">
	<h1 style="margin: 0px; padding-top: 35px; padding-bottom: 0px;">Z75 MDIS Driver &nbsp; </h1>
	<h3>z75_drv.c Source File</h3>
</div>

<div class="left_to_right">
<!-- Hauptteil -->
	<div class="main">
<!-- Generated by Doxygen 1.3.2 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a> | <a class="qindex" href="examples.html">Examples</a></div>
<h1>z75_drv.c</h1><a href="z75__drv_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/*********************  P r o g r a m  -  M o d u l e ***********************/</span>
00017  <span class="comment">/*</span>
00018 <span class="comment"> * This program is free software: you can redistribute it and/or modify</span>
00019 <span class="comment"> * it under the terms of the GNU General Public License as published by</span>
00020 <span class="comment"> * the Free Software Foundation, either version 2 of the License, or</span>
00021 <span class="comment"> * (at your option) any later version.</span>
00022 <span class="comment"> *</span>
00023 <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
00024 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00025 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
00026 <span class="comment"> * GNU General Public License for more details.</span>
00027 <span class="comment"> *</span>
00028 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
00029 <span class="comment"> * along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
00030 <span class="comment"> */</span>
00031 
00032 <span class="preprocessor">#include "<a class="code" href="z75__int_8h.html">z75_int.h</a>"</span>
00033 
00034 
00035 <span class="preprocessor">#ifdef MAC_BYTESWAP</span>
00036 <span class="preprocessor"></span>    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="z75__drv_8c.html#a0">IdentString</a>[]=MENT_XSTR_SFX(MAK_REVISION,Z75 swapped);
00037 <span class="preprocessor">#else</span>
<a name="l00038"></a><a class="code" href="z75__drv_8c.html#a0">00038</a> <span class="preprocessor"></span>    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="z75__drv_8c.html#a0">IdentString</a>[]=MENT_XSTR_SFX(MAK_REVISION,Z75 nonswapped);
00039 <span class="preprocessor">#endif</span>
00040 <span class="preprocessor"></span>
00041 
00042 <span class="comment">/****************************** Z75_GetEntry ********************************/</span>
00047 <span class="preprocessor">#ifdef _ONE_NAMESPACE_PER_DRIVER_</span>
00048 <span class="preprocessor"></span>    <span class="keyword">extern</span> <span class="keywordtype">void</span> LL_GetEntry( LL_ENTRY* drvP )
00049 #<span class="keywordflow">else</span>
<a name="l00050"></a><a class="code" href="z75__drv_8c.html#a1">00050</a>     <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="z75__drv_8c.html#a1">Z75_GetEntry</a>( LL_ENTRY* drvP )
00051 #endif <span class="comment">/* _ONE_NAMESPACE_PER_DRIVER_ */</span>
00052 {
00053     drvP-&gt;init        = <a class="code" href="z75__drv_8c.html#a2">Z75_Init</a>;
00054     drvP-&gt;exit        = <a class="code" href="z75__drv_8c.html#a3">Z75_Exit</a>;
00055     drvP-&gt;read        = <a class="code" href="z75__drv_8c.html#a4">Z75_Read</a>;
00056     drvP-&gt;write       = <a class="code" href="z75__drv_8c.html#a5">Z75_Write</a>;
00057     drvP-&gt;blockRead   = <a class="code" href="z75__drv_8c.html#a8">Z75_BlockRead</a>;
00058     drvP-&gt;blockWrite  = <a class="code" href="z75__drv_8c.html#a9">Z75_BlockWrite</a>;
00059     drvP-&gt;setStat     = <a class="code" href="z75__drv_8c.html#a6">Z75_SetStat</a>;
00060     drvP-&gt;getStat     = <a class="code" href="z75__drv_8c.html#a7">Z75_GetStat</a>;
00061     drvP-&gt;irq         = <a class="code" href="z75__drv_8c.html#a10">Z75_Irq</a>;
00062     drvP-&gt;info        = <a class="code" href="z75__drv_8c.html#a11">Z75_Info</a>;
00063 }
00064 
00065 <span class="comment">/******************************** Z75_Init **********************************/</span>
<a name="l00083"></a><a class="code" href="z75__drv_8c.html#a2">00083</a> <span class="keyword">static</span> int32 <a class="code" href="z75__int_8h.html#a20">Z75_Init</a>(
00084     DESC_SPEC       *descP,
00085     OSS_HANDLE      *osHdl,
00086     MACCESS         *ma,
00087     OSS_SEM_HANDLE  *devSemHdl,
00088     OSS_IRQ_HANDLE  *irqHdl,
00089     <a class="code" href="structLL__HANDLE.html">LL_HANDLE</a>       **llHdlP
00090 )
00091 {
00092     <a class="code" href="structLL__HANDLE.html">LL_HANDLE</a> *llHdl = NULL;
00093     u_int32 gotsize;
00094     int32 error;
00095     u_int32 value;
00096 
00097     <span class="comment">/*------------------------------+</span>
00098 <span class="comment">    |  prepare the handle           |</span>
00099 <span class="comment">    +------------------------------*/</span>
00100     *llHdlP = NULL;     <span class="comment">/* set low-level driver handle to NULL */</span>
00101 
00102     <span class="comment">/* alloc */</span>
00103     <span class="keywordflow">if</span> ((llHdl = (<a class="code" href="structLL__HANDLE.html">LL_HANDLE</a>*)OSS_MemGet(
00104                     osHdl, <span class="keyword">sizeof</span>(<a class="code" href="structLL__HANDLE.html">LL_HANDLE</a>), &amp;gotsize)) == NULL)
00105        <span class="keywordflow">return</span>(ERR_OSS_MEM_ALLOC);
00106 
00107     <span class="comment">/* clear */</span>
00108     OSS_MemFill(osHdl, gotsize, (<span class="keywordtype">char</span>*)llHdl, 0x00);
00109 
00110     <span class="comment">/* init */</span>
00111     llHdl-&gt;memAlloc   = gotsize;
00112     llHdl-&gt;osHdl      = osHdl;
00113     llHdl-&gt;irqHdl     = irqHdl;
00114     llHdl-&gt;ma         = *ma;
00115 
00116     <span class="comment">/*------------------------------+</span>
00117 <span class="comment">    |  init id function table       |</span>
00118 <span class="comment">    +------------------------------*/</span>
00119     <span class="comment">/* driver's ident function */</span>
00120     llHdl-&gt;idFuncTbl.idCall[0].identCall = <a class="code" href="z75__drv_8c.html#a12">Ident</a>;
00121     <span class="comment">/* library's ident functions */</span>
00122     llHdl-&gt;idFuncTbl.idCall[1].identCall = DESC_Ident;
00123     llHdl-&gt;idFuncTbl.idCall[2].identCall = OSS_Ident;
00124     <span class="comment">/* terminator */</span>
00125     llHdl-&gt;idFuncTbl.idCall[3].identCall = NULL;
00126 
00127     <span class="comment">/*------------------------------+</span>
00128 <span class="comment">    |  prepare debugging            |</span>
00129 <span class="comment">    +------------------------------*/</span>
00130     <a class="code" href="z75__int_8h.html#a5">DBG_MYLEVEL</a> = OSS_DBG_DEFAULT;  <span class="comment">/* set OS specific debug level */</span>
00131     DBGINIT((NULL,&amp;<a class="code" href="z75__int_8h.html#a6">DBH</a>));
00132 
00133     <span class="comment">/*------------------------------+</span>
00134 <span class="comment">    |  scan descriptor              |</span>
00135 <span class="comment">    +------------------------------*/</span>
00136     <span class="comment">/* prepare access */</span>
00137     <span class="keywordflow">if</span> ((error = DESC_Init(descP, osHdl, &amp;llHdl-&gt;descHdl)))
00138         <span class="keywordflow">return</span>( <a class="code" href="z75__int_8h.html#a31">Cleanup</a>(llHdl,error) );
00139 
00140     <span class="comment">/* DEBUG_LEVEL_DESC */</span>
00141     <span class="keywordflow">if</span> ((error = DESC_GetUInt32(llHdl-&gt;descHdl, OSS_DBG_DEFAULT,
00142                                 &amp;value, <span class="stringliteral">"DEBUG_LEVEL_DESC"</span>)) &amp;&amp;
00143         error != ERR_DESC_KEY_NOTFOUND)
00144         <span class="keywordflow">return</span>( <a class="code" href="z75__int_8h.html#a31">Cleanup</a>(llHdl,error) );
00145 
00146     DESC_DbgLevelSet(llHdl-&gt;descHdl, value);    <span class="comment">/* set level */</span>
00147 
00148     <span class="comment">/* DEBUG_LEVEL */</span>
00149     <span class="keywordflow">if</span> ((error = DESC_GetUInt32(llHdl-&gt;descHdl, OSS_DBG_DEFAULT,
00150                                 &amp;llHdl-&gt;dbgLevel, <span class="stringliteral">"DEBUG_LEVEL"</span>)) &amp;&amp;
00151         error != ERR_DESC_KEY_NOTFOUND)
00152         <span class="keywordflow">return</span>( <a class="code" href="z75__int_8h.html#a31">Cleanup</a>(llHdl,error) );
00153 
00154     DBGWRT_1((<a class="code" href="z75__int_8h.html#a6">DBH</a>, <span class="stringliteral">"LL - Z75_Init\n"</span>));
00155 
00156     <span class="comment">/*------------------------------------+</span>
00157 <span class="comment">    |  init hardware and read descriptor  |</span>
00158 <span class="comment">    +------------------------------------*/</span>
00159 
00160     <span class="comment">/**************************</span>
00161 <span class="comment">     * FPGA System core clock</span>
00162 <span class="comment">     */</span>
00163     value = 0;
00164 
00165     <span class="keywordflow">if</span> ((error = DESC_GetUInt32(llHdl-&gt;descHdl, <a class="code" href="z75__int_8h.html#a16">Z075_DESC_DEF_SYSCLK</a>,
00166                             &amp;value, <span class="stringliteral">"Z075_SYSCLK"</span>)) &amp;&amp;
00167         error != ERR_DESC_KEY_NOTFOUND)
00168         <span class="keywordflow">return</span>( <a class="code" href="z75__int_8h.html#a31">Cleanup</a>(llHdl,error) );
00169 
00170     llHdl-&gt;fpgaSysClk = value;
00171 
00172 
00173     <span class="comment">/**************************</span>
00174 <span class="comment">     * Resolution</span>
00175 <span class="comment">     */</span>
00176     value = 0;
00177 
00178     <span class="keywordflow">if</span> ((error = DESC_GetUInt32(llHdl-&gt;descHdl, <a class="code" href="z75__int_8h.html#a17">Z075_DESC_DEF_RESOLUTION</a>,
00179                             &amp;value, <span class="stringliteral">"Z075_RESOLUTION"</span>)) &amp;&amp;
00180         error != ERR_DESC_KEY_NOTFOUND )
00181         <span class="keywordflow">return</span>( <a class="code" href="z75__int_8h.html#a31">Cleanup</a>(llHdl,error) );
00182 
00183     <span class="keywordflow">if</span>( value &lt; 8 ){
00184         llHdl-&gt;res = (u_int16)value;
00185     }
00186     <span class="keywordflow">else</span>{
00187         error = ERR_DESC_CORRUPTED;
00188         <span class="keywordflow">return</span>( <a class="code" href="z75__int_8h.html#a31">Cleanup</a>(llHdl,error) );
00189     }
00190 
00191     <span class="comment">/* write initial value to SPEED CTRL_STS register */</span>
00192     MWRITE_D32( llHdl-&gt;ma, <a class="code" href="z75__int_8h.html#a8">Z075_CTRL_STS_ADDR_OFFSET</a>, value );
00193 
00194     <span class="comment">/**************************</span>
00195 <span class="comment">     * Upper limit</span>
00196 <span class="comment">     */</span>
00197     value = 0;
00198 
00199     <span class="keywordflow">if</span> ((error = DESC_GetUInt32(llHdl-&gt;descHdl, <a class="code" href="z75__int_8h.html#a18">Z075_DESC_DEF_UPLTD</a>,
00200                             &amp;value, <span class="stringliteral">"Z075_A_UPPER_LIMIT"</span>)) &amp;&amp;
00201         error != ERR_DESC_KEY_NOTFOUND)
00202         <span class="keywordflow">return</span>( <a class="code" href="z75__int_8h.html#a31">Cleanup</a>(llHdl,error) );
00203 
00204     llHdl-&gt;upLimit = value;
00205 
00206     <span class="comment">/**************************</span>
00207 <span class="comment">     * Lower limit</span>
00208 <span class="comment">     */</span>
00209     value = 0;
00210 
00211     <span class="keywordflow">if</span> ((error = DESC_GetUInt32(llHdl-&gt;descHdl, <a class="code" href="z75__int_8h.html#a19">Z075_DESC_DEV_LOWLTD</a>,
00212                             &amp;value, <span class="stringliteral">"Z075_A_LOWER_LIMIT"</span>)) &amp;&amp;
00213         error != ERR_DESC_KEY_NOTFOUND)
00214         <span class="keywordflow">return</span>( <a class="code" href="z75__int_8h.html#a31">Cleanup</a>(llHdl,error) );
00215 
00216     llHdl-&gt;upLimit = value;
00217 
00218     <span class="comment">/**************************</span>
00219 <span class="comment">     * Check limits</span>
00220 <span class="comment">     */</span>
00221     <span class="keywordflow">if</span>( llHdl-&gt;lowLimit &gt;= llHdl-&gt;upLimit ){
00222         llHdl-&gt;lowLimit = llHdl-&gt;upLimit - 1;
00223     }
00224 
00225     llHdl-&gt;startFlag = 0;
00226     llHdl-&gt;autoMode = 0;
00227 
00228     *llHdlP = llHdl;    <span class="comment">/* set low-level driver handle */</span>
00229 
00230     <span class="keywordflow">return</span>(ERR_SUCCESS);
00231 }
00232 
00233 <span class="comment">/****************************** Z75_Exit ************************************/</span>
<a name="l00243"></a><a class="code" href="z75__drv_8c.html#a3">00243</a> <span class="keyword">static</span> int32 <a class="code" href="z75__int_8h.html#a21">Z75_Exit</a>(
00244    <a class="code" href="structLL__HANDLE.html">LL_HANDLE</a>    **llHdlP
00245 )
00246 {
00247     <a class="code" href="structLL__HANDLE.html">LL_HANDLE</a> *llHdl = *llHdlP;
00248     int32 error = 0;
00249 
00250     DBGWRT_1((<a class="code" href="z75__int_8h.html#a6">DBH</a>, <span class="stringliteral">"LL - Z75_Exit\n"</span>));
00251 
00252     <span class="comment">/*------------------------------+</span>
00253 <span class="comment">    |  de-init hardware             |</span>
00254 <span class="comment">    +------------------------------*/</span>
00255     <span class="comment">/* stop measurement */</span>
00256     MWRITE_D32( llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o4">ma</a>, <a class="code" href="z75__int_8h.html#a8">Z075_CTRL_STS_ADDR_OFFSET</a>, 0 );
00257 
00258     <span class="comment">/*------------------------------+</span>
00259 <span class="comment">    |  clean up memory               |</span>
00260 <span class="comment">    +------------------------------*/</span>
00261     *llHdlP = NULL;     <span class="comment">/* set low-level driver handle to NULL */</span>
00262     error = <a class="code" href="z75__int_8h.html#a31">Cleanup</a>(llHdl,error);
00263 
00264     <span class="keywordflow">return</span>(error);
00265 }
00266 
00267 <span class="comment">/****************************** Z75_Read ************************************/</span>
<a name="l00281"></a><a class="code" href="z75__drv_8c.html#a4">00281</a> <span class="keyword">static</span> int32 <a class="code" href="z75__int_8h.html#a22">Z75_Read</a>(
00282     <a class="code" href="structLL__HANDLE.html">LL_HANDLE</a> *llHdl,
00283     int32 ch,
00284     int32 *valueP
00285 )
00286 {
00287     <span class="keywordflow">return</span>(ERR_LL_ILL_FUNC);
00288 }
00289 
00290 <span class="comment">/****************************** Z75_Write ***********************************/</span>
<a name="l00304"></a><a class="code" href="z75__drv_8c.html#a5">00304</a> <span class="keyword">static</span> int32 <a class="code" href="z75__int_8h.html#a23">Z75_Write</a>(
00305     <a class="code" href="structLL__HANDLE.html">LL_HANDLE</a> *llHdl,
00306     int32 ch,
00307     int32 value
00308 )
00309 {
00310     <span class="keywordflow">return</span>(ERR_LL_ILL_FUNC);
00311 }
00312 
00313 <span class="comment">/****************************** Z75_SetStat *********************************/</span>
<a name="l00327"></a><a class="code" href="z75__drv_8c.html#a6">00327</a> <span class="keyword">static</span> int32 <a class="code" href="z75__int_8h.html#a24">Z75_SetStat</a>(
00328     <a class="code" href="structLL__HANDLE.html">LL_HANDLE</a> *llHdl,
00329     int32  code,
00330     int32  ch,
00331     INT32_OR_64 value32_or_64
00332 )
00333 {
00334     int32 value = (int32)value32_or_64;     <span class="comment">/* 32bit value */</span>
00335     <span class="comment">/* INT32_OR_64 valueP = value32_or_64;    stores 32/64bit pointer */</span>
00336     int32 error = ERR_SUCCESS;
00337     DBGCMD( <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> functionName[] = <span class="stringliteral">"Z75 SetStat"</span>; )
00338 
00339     DBGWRT_1((<a class="code" href="z75__int_8h.html#a6">DBH</a>, <span class="stringliteral">"LL - Z75_SetStat: ch=%d code=0x%04x value=0x%x\n"</span>,
00340               ch,code,value));
00341 
00342     <span class="keywordflow">switch</span>(code) {
00343         <span class="comment">/*--------------------------+</span>
00344 <span class="comment">        |  debug level              |</span>
00345 <span class="comment">        +--------------------------*/</span>
00346         <span class="keywordflow">case</span> M_LL_DEBUG_LEVEL:
00347             llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o7">dbgLevel</a> = value;
00348             <span class="keywordflow">break</span>;
00349         <span class="comment">/*--------------------------+</span>
00350 <span class="comment">        |  enable interrupts        |</span>
00351 <span class="comment">        +--------------------------*/</span>
00352         <span class="keywordflow">case</span> M_MK_IRQ_ENABLE:
00353             error = ERR_LL_UNK_CODE;    <span class="comment">/* say: not supported */</span>
00354             <span class="keywordflow">break</span>;
00355         <span class="comment">/*--------------------------+</span>
00356 <span class="comment">        |  set irq counter          |</span>
00357 <span class="comment">        +--------------------------*/</span>
00358         <span class="keywordflow">case</span> M_LL_IRQ_COUNT:
00359             llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o9">irqCount</a> = value;
00360             <span class="keywordflow">break</span>;
00361         <span class="comment">/*--------------------------+</span>
00362 <span class="comment">        |  set resolution           |</span>
00363 <span class="comment">        +--------------------------*/</span>
00364         <span class="keywordflow">case</span> Z075_RESOLUTION:
00365             value &amp;= <a class="code" href="z75__int_8h.html#a15">Z075_STS_RES_MSK</a>;
00366 
00367             <span class="keywordflow">if</span>( value &lt; 8 ){
00368                 MWRITE_D32( llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o4">ma</a>, <a class="code" href="z75__int_8h.html#a8">Z075_CTRL_STS_ADDR_OFFSET</a>, value );
00369                 llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o14">res</a> = (u_int16)value;
00370             }
00371             <span class="keywordflow">else</span>{
00372                 error = ERR_LL_ILL_PARAM;
00373             }
00374 
00375             <span class="keywordflow">break</span>;
00376 
00377         <span class="comment">/*--------------------------+</span>
00378 <span class="comment">        |  install upper signal     |</span>
00379 <span class="comment">        +--------------------------*/</span>
00380         <span class="keywordflow">case</span> Z075_SET_SIG_UPPER:
00381             <span class="keywordflow">if</span>( llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o17">upSigIdP</a> ){
00382                 error = ERR_OSS_SIG_SET;
00383                 <span class="keywordflow">break</span>;
00384             }
00385 
00386             error = OSS_SigCreate( llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o1">osHdl</a>, value, &amp;llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o17">upSigIdP</a> );
00387             <span class="keywordflow">break</span>;
00388         <span class="comment">/*--------------------------+</span>
00389 <span class="comment">        |  install lower signal     |</span>
00390 <span class="comment">        +--------------------------*/</span>
00391         <span class="keywordflow">case</span> Z075_SET_SIG_LOWER:
00392             <span class="keywordflow">if</span>( llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o16">lowSigIdP</a> ){
00393                 error = ERR_OSS_SIG_SET;
00394                 <span class="keywordflow">break</span>;
00395             }
00396 
00397             error = OSS_SigCreate( llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o1">osHdl</a>, value, &amp;llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o16">lowSigIdP</a> );
00398             <span class="keywordflow">break</span>;
00399 
00400         <span class="comment">/*--------------------------+</span>
00401 <span class="comment">        |  unregister upper signal  |</span>
00402 <span class="comment">        +--------------------------*/</span>
00403         <span class="keywordflow">case</span> Z075_CLR_SIG_UPPER:
00404 
00405             <span class="comment">/* signal already installed ? */</span>
00406             <span class="keywordflow">if</span>( llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o17">upSigIdP</a> == NULL ) {
00407                 error = ERR_OSS_SIG_CLR;
00408                 <span class="keywordflow">break</span>;
00409             }
00410 
00411             error = OSS_SigRemove( llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o1">osHdl</a>, &amp;llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o17">upSigIdP</a> );
00412             <span class="keywordflow">break</span>;
00413 
00414         <span class="comment">/*--------------------------+</span>
00415 <span class="comment">        |  unregister lower signal  |</span>
00416 <span class="comment">        +--------------------------*/</span>
00417         <span class="keywordflow">case</span> Z075_CLR_SIG_LOWER:
00418 
00419             <span class="comment">/* signal already installed ? */</span>
00420             <span class="keywordflow">if</span>( llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o16">lowSigIdP</a> == NULL ) {
00421                 error = ERR_OSS_SIG_CLR;
00422                 <span class="keywordflow">break</span>;
00423             }
00424 
00425             error = OSS_SigRemove( llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o1">osHdl</a>, &amp;llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o16">lowSigIdP</a> );
00426             <span class="keywordflow">break</span>;
00427 
00428 
00429         <span class="comment">/*--------------------------+</span>
00430 <span class="comment">        |  set upper limit          |</span>
00431 <span class="comment">        +--------------------------*/</span>
00432         <span class="keywordflow">case</span> Z075_A_UPPER_LTD:
00433             llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o11">upLimit</a> = value;
00434             <span class="keywordflow">break</span>;
00435 
00436         <span class="comment">/*--------------------------+</span>
00437 <span class="comment">        |  set lower limit          |</span>
00438 <span class="comment">        +--------------------------*/</span>
00439         <span class="keywordflow">case</span> Z075_A_LOWER_LTD:
00440             llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o12">lowLimit</a> = value;
00441             <span class="keywordflow">break</span>;
00442 
00443         <span class="comment">/*--------------------------+</span>
00444 <span class="comment">        |  start/stop measurement   |</span>
00445 <span class="comment">        +--------------------------*/</span>
00446         <span class="keywordflow">case</span> Z075_START_MEAS:
00447             <span class="keywordflow">if</span>( value ){
00448                 MWRITE_D32( llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o4">ma</a>, <a class="code" href="z75__int_8h.html#a8">Z075_CTRL_STS_ADDR_OFFSET</a>,
00449                     ( <a class="code" href="z75__int_8h.html#a14">Z075_STS_EN_MSK</a> | llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o14">res</a> ) );
00450                 llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o15">startFlag</a> = 1;
00451             }
00452             <span class="keywordflow">else</span>{
00453                 MWRITE_D32( llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o4">ma</a>, <a class="code" href="z75__int_8h.html#a8">Z075_CTRL_STS_ADDR_OFFSET</a>, llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o14">res</a>);
00454                 llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o15">startFlag</a> = 0;
00455             }
00456             <span class="keywordflow">break</span>;
00457 
00458         <span class="comment">/*--------------------------+</span>
00459 <span class="comment">        |  set lower limit          |</span>
00460 <span class="comment">        +--------------------------*/</span>
00461         <span class="keywordflow">case</span> Z075_AUTO_MODE:
00462             llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o13">autoMode</a> = (u_int8)value;
00463 
00464             <span class="keywordflow">if</span>( value ){    <span class="comment">/* enable alarm */</span>
00465                 <span class="keywordflow">if</span>( (error = OSS_AlarmCreate( llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o1">osHdl</a>,
00466                                               <a class="code" href="z75__drv_8c.html#a15">automatedTsk</a>,
00467                                               (<span class="keywordtype">void</span> *)llHdl,
00468                                               &amp;llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o6">alarmHdl</a>)) )
00469                 {
00470                     DBGWRT_ERR( (<a class="code" href="z75__int_8h.html#a6">DBH</a>, <span class="stringliteral">"*** %s: can't create alarm:"</span> \
00471                         <span class="stringliteral">" err=%d!!!\n"</span>, functionName, error) );
00472                     <span class="keywordflow">goto</span> ERR_EXIT;
00473                 }
00474 
00475                 <span class="keywordflow">if</span>( (error = OSS_AlarmSet( llHdl-&gt;osHdl,
00476                                            llHdl-&gt;alarmHdl,
00477                                            (u_int32)value,
00478                                            1,
00479                                            &amp;llHdl-&gt;realMsec)) )
00480                 {
00481                     DBGWRT_ERR( (<a class="code" href="z75__int_8h.html#a6">DBH</a>, <span class="stringliteral">"*** %s: can't set alarm to"</span> \
00482                         <span class="stringliteral">" cyclic all %d ms: err=%d!!!\n"</span>,
00483                         functionName, (<span class="keywordtype">int</span>)value, error) );
00484 
00485                     <span class="keywordflow">goto</span> ERR_EXIT;
00486                 }
00487             }
00488             <span class="keywordflow">else</span>{       <span class="comment">/* disable alarm */</span>
00489                 OSS_AlarmClear( llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o1">osHdl</a>, llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o6">alarmHdl</a> );
00490 
00491                 <span class="comment">/* remove alarm */</span>
00492                 <span class="keywordflow">if</span>( llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o6">alarmHdl</a> ){
00493                     OSS_AlarmRemove( llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o1">osHdl</a>, &amp;llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o6">alarmHdl</a> );
00494                 }
00495             }
00496             <span class="keywordflow">break</span>;
00497 
00498         <span class="comment">/*--------------------------+</span>
00499 <span class="comment">        |  (unknown)                |</span>
00500 <span class="comment">        +--------------------------*/</span>
00501         <span class="keywordflow">default</span>:
00502             error = ERR_LL_UNK_CODE;
00503     }
00504 ERR_EXIT:
00505 
00506     <span class="keywordflow">return</span>(error);
00507 }
00508 
00509 <span class="comment">/****************************** Z75_GetStat *********************************/</span>
<a name="l00525"></a><a class="code" href="z75__drv_8c.html#a7">00525</a> <span class="keyword">static</span> int32 <a class="code" href="z75__int_8h.html#a25">Z75_GetStat</a>(
00526     <a class="code" href="structLL__HANDLE.html">LL_HANDLE</a> *llHdl,
00527     int32  code,
00528     int32  ch,
00529     INT32_OR_64 *value32_or_64P
00530 )
00531 {
00532     int32       *valueP       = (int32*)value32_or_64P;       <span class="comment">/* pointer to 32bit value  */</span>
00533     <span class="comment">/* INT32_OR_64  *value64P     = value32_or_64P;               stores 32/64bit pointer  */</span>
00534     <span class="comment">/* M_SG_BLOCK   *blk          = (M_SG_BLOCK*)value32_or_64P;  stores block struct pointer */</span>
00535     int32 error = ERR_SUCCESS;
00536 
00537     DBGWRT_1((<a class="code" href="z75__int_8h.html#a6">DBH</a>, <span class="stringliteral">"LL - Z75_GetStat: ch=%d code=0x%04x\n"</span>,
00538               ch,code));
00539 
00540     <span class="keywordflow">switch</span>(code)
00541     {
00542         <span class="comment">/*--------------------------+</span>
00543 <span class="comment">        |  debug level              |</span>
00544 <span class="comment">        +--------------------------*/</span>
00545         <span class="keywordflow">case</span> M_LL_DEBUG_LEVEL:
00546             *valueP = llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o7">dbgLevel</a>;
00547             <span class="keywordflow">break</span>;
00548         <span class="comment">/*--------------------------+</span>
00549 <span class="comment">        |  number of channels       |</span>
00550 <span class="comment">        +--------------------------*/</span>
00551         <span class="keywordflow">case</span> M_LL_CH_NUMBER:
00552             *valueP = <a class="code" href="z75__int_8h.html#a1">CH_NUMBER</a>;
00553             <span class="keywordflow">break</span>;
00554         <span class="comment">/*--------------------------+</span>
00555 <span class="comment">        |  irq counter              |</span>
00556 <span class="comment">        +--------------------------*/</span>
00557         <span class="keywordflow">case</span> M_LL_IRQ_COUNT:
00558             *valueP = llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o9">irqCount</a>;
00559             <span class="keywordflow">break</span>;
00560         <span class="comment">/*--------------------------+</span>
00561 <span class="comment">        |  FREQUENCY                |</span>
00562 <span class="comment">        +--------------------------*/</span>
00563         <span class="keywordflow">case</span> Z075_FREQUENCY:
00564             error = <a class="code" href="z75__int_8h.html#a32">GetFreq</a>( llHdl, (u_int32*)valueP );
00565             <span class="keywordflow">break</span>;
00566 
00567         <span class="comment">/*--------------------------+</span>
00568 <span class="comment">        |  UPPER LIMIT              |</span>
00569 <span class="comment">        +--------------------------*/</span>
00570         <span class="keywordflow">case</span> Z075_A_UPPER_LTD:
00571             *valueP = llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o11">upLimit</a>;
00572             <span class="keywordflow">break</span>;
00573 
00574         <span class="comment">/*--------------------------+</span>
00575 <span class="comment">        |  LOWER LIMIT              |</span>
00576 <span class="comment">        +--------------------------*/</span>
00577         <span class="keywordflow">case</span> Z075_A_LOWER_LTD:
00578             *valueP = llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o12">lowLimit</a>;
00579             <span class="keywordflow">break</span>;
00580 
00581         <span class="comment">/*--------------------------+</span>
00582 <span class="comment">        |  RESOLUTION               |</span>
00583 <span class="comment">        +--------------------------*/</span>
00584         <span class="keywordflow">case</span> Z075_RESOLUTION:
00585             *valueP = llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o14">res</a>;
00586             <span class="keywordflow">break</span>;
00587 
00588         <span class="comment">/*--------------------------+</span>
00589 <span class="comment">        |  AUTOMATIC MODE           |</span>
00590 <span class="comment">        +--------------------------*/</span>
00591         <span class="keywordflow">case</span> Z075_AUTO_MODE:
00592             *valueP = llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o13">autoMode</a>;
00593             <span class="keywordflow">break</span>;
00594 
00595         <span class="comment">/*--------------------------+</span>
00596 <span class="comment">        |  START/STOP MEASUREMENT   |</span>
00597 <span class="comment">        +--------------------------*/</span>
00598         <span class="keywordflow">case</span> Z075_START_MEAS:
00599             *valueP = llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o15">startFlag</a>;
00600             <span class="keywordflow">break</span>;
00601 
00602         <span class="comment">/*--------------------------+</span>
00603 <span class="comment">        |  unknown                  |</span>
00604 <span class="comment">        +--------------------------*/</span>
00605         <span class="keywordflow">default</span>:
00606             error = ERR_LL_UNK_CODE;
00607     }
00608 
00609     <span class="keywordflow">return</span>(error);
00610 }
00611 
00612 <span class="comment">/******************************* Z75_BlockRead ******************************/</span>
<a name="l00623"></a><a class="code" href="z75__drv_8c.html#a8">00623</a> <span class="keyword">static</span> int32 <a class="code" href="z75__int_8h.html#a26">Z75_BlockRead</a>(
00624      <a class="code" href="structLL__HANDLE.html">LL_HANDLE</a> *llHdl,
00625      int32     ch,
00626      <span class="keywordtype">void</span>      *buf,
00627      int32     size,
00628      int32     *nbrRdBytesP
00629 )
00630 {
00631     <span class="keywordflow">return</span>(ERR_LL_ILL_FUNC);
00632 }
00633 
00634 <span class="comment">/****************************** Z75_BlockWrite ******************************/</span>
<a name="l00645"></a><a class="code" href="z75__drv_8c.html#a9">00645</a> <span class="keyword">static</span> int32 <a class="code" href="z75__int_8h.html#a27">Z75_BlockWrite</a>(
00646      <a class="code" href="structLL__HANDLE.html">LL_HANDLE</a> *llHdl,
00647      int32     ch,
00648      <span class="keywordtype">void</span>      *buf,
00649      int32     size,
00650      int32     *nbrWrBytesP
00651 )
00652 {
00653     <span class="keywordflow">return</span>(ERR_LL_ILL_FUNC);
00654 }
00655 
00656 
00657 <span class="comment">/****************************** Z75_Irq ************************************/</span>
<a name="l00670"></a><a class="code" href="z75__drv_8c.html#a10">00670</a> <span class="keyword">static</span> int32 <a class="code" href="z75__int_8h.html#a28">Z75_Irq</a>(
00671    <a class="code" href="structLL__HANDLE.html">LL_HANDLE</a> *llHdl
00672 )
00673 {
00674     IDBGWRT_1((<a class="code" href="z75__int_8h.html#a6">DBH</a>, <span class="stringliteral">"&gt;&gt;&gt; Z75_Irq:\n"</span>));
00675 
00676     <span class="comment">/* ... */</span>
00677 
00678     llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o9">irqCount</a>++;
00679 
00680     <span class="keywordflow">return</span>(LL_IRQ_DEV_NOT);
00681 }
00682 
00683 <span class="comment">/****************************** Z75_Info ***********************************/</span>
<a name="l00721"></a><a class="code" href="z75__drv_8c.html#a11">00721</a> <span class="keyword">static</span> int32 <a class="code" href="z75__int_8h.html#a29">Z75_Info</a>(
00722    int32  infoType,
00723    ...
00724 )
00725 {
00726     int32   error = ERR_SUCCESS;
00727     va_list argptr;
00728 
00729     va_start(argptr, infoType );
00730 
00731     <span class="keywordflow">switch</span>(infoType) {
00732         <span class="comment">/*-------------------------------+</span>
00733 <span class="comment">        |  hardware characteristics      |</span>
00734 <span class="comment">        |  (all addr/data modes ORed)   |</span>
00735 <span class="comment">        +-------------------------------*/</span>
00736         <span class="keywordflow">case</span> LL_INFO_HW_CHARACTER:
00737         {
00738             u_int32 *addrModeP = va_arg(argptr, u_int32*);
00739             u_int32 *dataModeP = va_arg(argptr, u_int32*);
00740 
00741             *addrModeP = MDIS_MA08;
00742             *dataModeP = MDIS_MD08 | MDIS_MD16;
00743             <span class="keywordflow">break</span>;
00744         }
00745         <span class="comment">/*-------------------------------+</span>
00746 <span class="comment">        |  nr of required address spaces |</span>
00747 <span class="comment">        |  (total spaces used)           |</span>
00748 <span class="comment">        +-------------------------------*/</span>
00749         <span class="keywordflow">case</span> LL_INFO_ADDRSPACE_COUNT:
00750         {
00751             u_int32 *nbrOfAddrSpaceP = va_arg(argptr, u_int32*);
00752 
00753             *nbrOfAddrSpaceP = <a class="code" href="z75__int_8h.html#a3">ADDRSPACE_COUNT</a>;
00754             <span class="keywordflow">break</span>;
00755         }
00756         <span class="comment">/*-------------------------------+</span>
00757 <span class="comment">        |  address space type            |</span>
00758 <span class="comment">        |  (widest used data mode)       |</span>
00759 <span class="comment">        +-------------------------------*/</span>
00760         <span class="keywordflow">case</span> LL_INFO_ADDRSPACE:
00761         {
00762             u_int32 addrSpaceIndex = va_arg(argptr, u_int32);
00763             u_int32 *addrModeP = va_arg(argptr, u_int32*);
00764             u_int32 *dataModeP = va_arg(argptr, u_int32*);
00765             u_int32 *addrSizeP = va_arg(argptr, u_int32*);
00766 
00767             <span class="keywordflow">if</span> (addrSpaceIndex &gt;= <a class="code" href="z75__int_8h.html#a3">ADDRSPACE_COUNT</a>)
00768                 error = ERR_LL_ILL_PARAM;
00769             <span class="keywordflow">else</span> {
00770                 *addrModeP = MDIS_MA08;
00771                 *dataModeP = MDIS_MD16;
00772                 *addrSizeP = <a class="code" href="z75__int_8h.html#a4">ADDRSPACE_SIZE</a>;
00773             }
00774 
00775             <span class="keywordflow">break</span>;
00776         }
00777         <span class="comment">/*-------------------------------+</span>
00778 <span class="comment">        |   interrupt required           |</span>
00779 <span class="comment">        +-------------------------------*/</span>
00780         <span class="keywordflow">case</span> LL_INFO_IRQ:
00781         {
00782             u_int32 *useIrqP = va_arg(argptr, u_int32*);
00783 
00784             *useIrqP = <a class="code" href="z75__int_8h.html#a2">USE_IRQ</a>;
00785             <span class="keywordflow">break</span>;
00786         }
00787         <span class="comment">/*-------------------------------+</span>
00788 <span class="comment">        |   process lock mode            |</span>
00789 <span class="comment">        +-------------------------------*/</span>
00790         <span class="keywordflow">case</span> LL_INFO_LOCKMODE:
00791         {
00792             u_int32 *lockModeP = va_arg(argptr, u_int32*);
00793 
00794             *lockModeP = LL_LOCK_CALL;
00795             <span class="keywordflow">break</span>;
00796         }
00797         <span class="comment">/*-------------------------------+</span>
00798 <span class="comment">        |   (unknown)                    |</span>
00799 <span class="comment">        +-------------------------------*/</span>
00800         <span class="keywordflow">default</span>:
00801           error = ERR_LL_ILL_PARAM;
00802     }
00803 
00804     va_end(argptr);
00805     <span class="keywordflow">return</span>(error);
00806 }
00807 
00808 <span class="comment">/*******************************  Ident  ***********************************/</span>
<a name="l00813"></a><a class="code" href="z75__drv_8c.html#a12">00813</a> <span class="keyword">static</span> <span class="keywordtype">char</span>* <a class="code" href="z75__drv_8c.html#a12">Ident</a>( <span class="keywordtype">void</span> )
00814 {
00815     <span class="keywordflow">return</span>( (<span class="keywordtype">char</span>*) <a class="code" href="z75__drv_8c.html#a0">IdentString</a> );
00816 }
00817 
00818 <span class="comment">/********************************* Cleanup *********************************/</span>
<a name="l00828"></a><a class="code" href="z75__drv_8c.html#a13">00828</a> <span class="keyword">static</span> int32 <a class="code" href="z75__int_8h.html#a31">Cleanup</a>(
00829    <a class="code" href="structLL__HANDLE.html">LL_HANDLE</a>    *llHdl,
00830    int32        retCode
00831 )
00832 {
00833     <span class="comment">/*------------------------------+</span>
00834 <span class="comment">    |  close handles                |</span>
00835 <span class="comment">    +------------------------------*/</span>
00836     <span class="comment">/* clean up desc */</span>
00837     <span class="keywordflow">if</span> (llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o3">descHdl</a>)
00838         DESC_Exit(&amp;llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o3">descHdl</a>);
00839 
00840     <span class="comment">/* clean up debug */</span>
00841     DBGEXIT((&amp;<a class="code" href="z75__int_8h.html#a6">DBH</a>));
00842 
00843     <span class="comment">/*------------------------------+</span>
00844 <span class="comment">    |  free memory                  |</span>
00845 <span class="comment">    +------------------------------*/</span>
00846     <span class="comment">/* free my handle */</span>
00847     OSS_MemFree(llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o1">osHdl</a>, (int8*)llHdl, llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o0">memAlloc</a>);
00848 
00849     <span class="comment">/*------------------------------+</span>
00850 <span class="comment">    |  return error code            |</span>
00851 <span class="comment">    +------------------------------*/</span>
00852     <span class="keywordflow">return</span>(retCode);
00853 }
00854 
00855 <span class="comment">/********************************* GetFreq *********************************/</span>
<a name="l00863"></a><a class="code" href="z75__drv_8c.html#a14">00863</a> <span class="keyword">static</span> int32 <a class="code" href="z75__int_8h.html#a32">GetFreq</a>( <a class="code" href="structLL__HANDLE.html">LL_HANDLE</a> *llHdl, u_int32 *freqP )
00864 {
00865     u_int32 result = 0;
00866     u_int32 ctrl = 0;
00867     u_int32 meas = 0;
00868     u_int32 period = 0;
00869     u_int32 freq = 0;
00870 
00871     int32 error = ERR_SUCCESS;
00872 
00873     <span class="comment">/* read result register */</span>
00874     result = MREAD_D32( llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o4">ma</a>, <a class="code" href="z75__int_8h.html#a7">Z075_RESULT_ADDR_OFFSET</a>);
00875 
00876     <span class="comment">/* read status register */</span>
00877     ctrl = MREAD_D32( llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o4">ma</a>, <a class="code" href="z75__int_8h.html#a8">Z075_CTRL_STS_ADDR_OFFSET</a>);
00878 
00879     <span class="comment">/* check new value */</span>
00880     <span class="keywordflow">if</span>( ctrl &amp; <a class="code" href="z75__int_8h.html#a12">Z075_STS_LOW_MSK</a> || ctrl &amp; <a class="code" href="z75__int_8h.html#a13">Z075_STS_HIGH_MSK</a> ||
00881         !(result &amp; <a class="code" href="z75__int_8h.html#a11">Z075_RES_NEW_VALUE_MSK</a>) ){
00882         *freqP = 0;
00883         error = ERR_LL_READ;
00884     }
00885 
00886     <span class="comment">/* calculate frequency */</span>
00887     period = (result &amp; <a class="code" href="z75__int_8h.html#a10">Z075_RES_PERIOD_MSK</a>) &gt;&gt; 20;
00888     meas = result &amp; <a class="code" href="z75__int_8h.html#a9">Z075_RES_MEAS_TIME_MSK</a>;
00889 
00890     <span class="keywordflow">if</span>( <a class="code" href="z75__int_8h.html#a34">checkRange</a>( llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o10">fpgaSysClk</a>, period ) ){
00891         freq = period * ( llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o10">fpgaSysClk</a> / meas);
00892     }
00893     <span class="keywordflow">else</span>{
00894         freq = (period * llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o10">fpgaSysClk</a>) / meas;
00895     }
00896 
00897     DBGWRT_1((<a class="code" href="z75__int_8h.html#a6">DBH</a>, <span class="stringliteral">"LL - Z75_GetFreq: freq=%d period=%d meas=%d\n"</span>, freq, \
00898         period, meas ));
00899 
00900     *freqP = freq;
00901 
00902     <span class="keywordflow">return</span> error;
00903 }
00904 
00905 <span class="comment">/**************************** automatedTsk *******************************/</span>
<a name="l00911"></a><a class="code" href="z75__drv_8c.html#a15">00911</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="z75__int_8h.html#a33">automatedTsk</a>( <span class="keywordtype">void</span> *hdl )
00912 {
00913     <a class="code" href="structLL__HANDLE.html">LL_HANDLE</a> *llHdl = (<a class="code" href="structLL__HANDLE.html">LL_HANDLE</a>*)hdl;
00914     u_int32 freq = 0;
00915 
00916     <span class="keywordflow">if</span>( llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o15">startFlag</a> == 0 ){
00917         <span class="keywordflow">return</span>;
00918     }
00919 
00920     <span class="keywordflow">if</span>( <a class="code" href="z75__int_8h.html#a32">GetFreq</a>( llHdl, &amp;freq ) == ERR_SUCCESS ){
00921 
00922         <span class="keywordflow">if</span>( (llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o12">lowLimit</a> &gt; freq) &amp;&amp; (llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o16">lowSigIdP</a> != NULL) ){
00923             <span class="comment">/* send signal to inform application */</span>
00924             OSS_SigSend( llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o1">osHdl</a>, llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o16">lowSigIdP</a> );
00925         }
00926 
00927         <span class="keywordflow">if</span>( (llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o11">upLimit</a> &lt; freq) &amp;&amp; (llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o17">upSigIdP</a> != NULL) ){
00928             <span class="comment">/* send signal to inform application */</span>
00929             OSS_SigSend( llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o1">osHdl</a>, llHdl-&gt;<a class="code" href="structLL__HANDLE.html#o17">upSigIdP</a> );
00930         }
00931     }
00932 }
00933 
00934 <span class="comment">/**************************** checkRange *******************************/</span>
<a name="l00941"></a><a class="code" href="z75__drv_8c.html#a16">00941</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="z75__int_8h.html#a34">checkRange</a>( u_int32 clk, u_int32 per )
00942 {
00943     <span class="keywordflow">if</span>( per &gt; (0xffffffff / clk) ){
00944         <span class="keywordflow">return</span> 1;
00945     }
00946     <span class="keywordflow">else</span>{
00947         <span class="keywordflow">return</span> 0;
00948     }
00949 }
00950 
</pre></div>
	</div>
</div>

<div class="footer">
<!-- Footer -->
	<p class="footer">
	Generated for Z75 MDIS Driver using <a href="http://www.doxygen.org">doxygen</a>. All Rights Reserved.
	</p>
</div>

</body>
</html>

